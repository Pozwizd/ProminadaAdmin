<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{template/layout.html}">
<head>
    <meta charset="UTF-8">
    <title></title>
    <style>
        .was-validated .form-check-input:valid, .form-check-input.is-valid {
            background-color: #6600ffe3 !important;
        }

        .file-hidden {
            display: none !important;
        }

        .uploadButton {
            display: inline-block;
            padding: 10px 20px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }

        .uploadButton:hover {
            background-color: #0056b3;
        }
    </style>

    <link rel="stylesheet" th:href="@{/assets/vendor/libs/dropzone/dropzone.css}"/>
</head>
<body>
<div layout:fragment="content">
    <div class="d-flex justify-content-between align-items-center py-3 mb-4">
        <h4 class="fw-bold m-0" data-i18n="builder.createTarget">Создать Здание</h4>
    </div>

    <div class="card mb-4">
        <div class="card-body">
            <div class="nav-align-top">
                <ul class="nav nav-pills mb-4" role="tablist">
                    <li class="nav-item">
                        <button
                                type="button"
                                class="nav-link active"
                                role="tab"
                                data-bs-toggle="tab"
                                data-bs-target="#navs-pills-top-home"
                                aria-controls="navs-pills-top-home"
                                aria-selected="true">
                            Основное
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                                type="button"
                                class="nav-link"
                                role="tab"
                                data-bs-toggle="tab"
                                data-bs-target="#navs-pills-top-profile"
                                aria-controls="navs-pills-top-profile"
                                aria-selected="false">
                            Галерея
                        </button>
                    </li>
                    <li class="nav-item">
                        <button
                                type="button"
                                class="nav-link"
                                role="tab"
                                data-bs-toggle="tab"
                                data-bs-target="#navs-pills-top-messages"
                                aria-controls="navs-pills-top-messages"
                                aria-selected="false">
                            Планировки
                        </button>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="navs-pills-top-home" role="tabpanel">
                        <form id="personalForm" class="row g-3 needs-validation" novalidate>
                            <input type="hidden" id="builderId">
                            <div class="col-md-3">
                                <label for="name" class="form-label" data-i18n="builder.name">Название</label>
                                <input type="text" class="form-control" id="name"
                                       data-i18n="[placeholder]builder.namePlaceHolder"
                                       placeholder="ЖК 'Ривьера Сити'" data-error="name">
                                <!--                                <div class="invalid-feedback" data-i18n="builder.surnameRequired">Пожалуйста, введите-->
                                <!--                                    фамилию-->
                                <!--                                </div>-->
                            </div>

                            <div class="col-md-3">
                                <label for="regDistrictId" class="form-label" data-i18n="builder.regDistrict">Обл.
                                    район</label>
                                <select class="form-select" id="regDistrictId" required>
                                    <option value="" data-i18n="builder.selectRegDistrict"></option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="cityId" class="form-label" data-i18n="builder.city">Нас. пункт</label>
                                <select class="form-select" id="cityId" required disabled>
                                    <option value="" data-i18n="builder.selectCity">Выберите нас. пункт</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="districtId" class="form-label"
                                       data-i18n="builder.selectDistrict">Район</label>
                                <select class="form-select" id="districtId" required disabled>
                                    <option value="" data-i18n="builder.selectDistrict">Выберите район</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="topozoneId" class="form-label" data-i18n="builder.topozone">Топозона</label>
                                <select class="form-select" id="topozoneId" required disabled>
                                    <option value="" data-i18n="builder.selectTopozone">Выберите топзону</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="street" class="form-label" data-i18n="builder.street">Улица</label>
                                <input type="text" class="form-control" id="street"
                                       placeholder="Чехова" required
                                       data-error="street"
                                       data-i18n="[placeholder]builder.streetPlaceHolder">
                                <div class="invalid-feedback" data-i18n="personal.surnameRequired">Пожалуйста, введите
                                    улицу
                                </div>
                            </div>

                            <div class="col-md-6"></div>

                            <div class="col-md-2">
                                <label for="houseNumber" class="form-label" data-i18n="builder.houseNumber">Номер
                                    дома</label>
                                <input type="text" class="form-control" id="houseNumber" placeholder="7" required
                                       data-error="houseNumber">
                                <div class="invalid-feedback" data-i18n="personal.surnameRequired">Пожалуйста,
                                    введите номер дома
                                </div>
                            </div>

                            <div class="col-md-2">
                                <label for="houseSection" class="form-label" data-i18n="builder.houseSection">Секция/корпус</label>
                                <input type="text" class="form-control" id="houseSection" placeholder="7" required>
                                <div class="invalid-feedback" data-i18n="personal.surnameRequired">Пожалуйста,
                                    введите раздел дома
                                </div>
                            </div>

                            <div class="col-md-2">
                                <label for="totalFloor" class="form-label"
                                       data-i18n="builder.totalFloor">Єтажность</label>
                                <input type="text" class="form-control" id="totalFloor" placeholder="9" required>
                                <div class="invalid-feedback" data-i18n="personal.surnameRequired">Пожалуйста,
                                    введите этажность
                                </div>
                            </div>

                            <div class="col-md-3">
                                <label for="buildingCompanyId" class="form-label" data-i18n="builder.buildingCompany">
                                    Строительная компания</label>
                                <select class="form-select" id="buildingCompanyId" required>
                                    <option value="" data-i18n="builder.selectCompany">Выберите компанию</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label for="deliveryDateId" class="form-label" data-i18n="deliveryType.selectDeliveryType">Срок сдачи</label>
                                <select class="form-select" id="deliveryDateId" required>
                                    <option value="" data-i18n="deliveryType.selectDeliveryType">Выберите тип сдачи</option>
                                    <option value="UNDER_CONSTRUCTION" data-i18n="deliveryType.underConstruction">Строится</option>
                                    <option value="PARTIALLY_DELIVERED" data-i18n="deliveryType.processOfHandingOver">В процессе сдачи</option>
                                    <option value="READY_FOR_OCCUPANCY" data-i18n="deliveryType.readyForOccupancy">Готово к заселению</option>
                                    <option value="COMPLETED" data-i18n="deliveryType.handedOver">Дом сдан</option>
                                </select>
                            </div>

                            <div class="col-md-4">
                                <label for="phoneNumber" class="form-label"
                                       data-i18n="builder.phone">Телефон</label>
                                <input type="tel" class="form-control" id="phoneNumber" placeholder="+380991112233"
                                       required data-error="phoneNumber">
                                <div class="invalid-feedback" data-i18n="personal.phoneRequired">Пожалуйста, введите
                                    телефон
                                </div>
                            </div>

                            <div class="col-md-8"></div>
                            <div class="col-md-4">
                                <label for="chessPlanFile" class="form-label"
                                       data-i18n="builder.chessPlan">Шахматка</label>
                                <input type="file" class="form-control file-hidden" id="chessPlanFile" data-error="chessPlanFile">
<!--                                <button type="button" class="btn btn-primary uploadButton" data-i18n="file.select">Виберіть файл</button>-->
                            </div>
                            <div class="col-md-8"></div>
                            <div class="col-md-4">
                                <label for="mortgageConditionsFile" class="form-label"
                                       data-i18n="builder.mortgageConditions">Условия
                                    рассрочки</label>
                                <input type="file" class="form-control file-hidden" id="mortgageConditionsFile"
                                       data-error="mortgageConditionsFile">
<!--                                <button type="button" class="btn btn-primary uploadButton" data-i18n="file.select">Виберіть файл</button>-->
                            </div>
                            <div class="col-md-8"></div>

                            <div class="col-md-4">
                                <label for="priceFile" class="form-label" data-i18n="builder.priceFile">Файл с
                                    ценами</label>
                                <input type="file" class="form-control file-hidden" id="priceFile" data-error="priceFile">
<!--                                <button type="button" class="btn btn-primary uploadButton" data-i18n="file.select">Виберіть файл</button>-->
                            </div>
                            <div class="col-md-8"></div>


                            <div class="col-md-4">
                                <label for="description" class="form-label" data-i18n="builder.description"
                                       data-error="description">Описание:</label>
                                <textarea class="form-control" id="description" rows="3" required></textarea>
                            </div>

                            <h4 data-i18n="builder.promotion">Акция</h4>
                            <div class="col-md-4">
                                <label for="actionTitle" class="form-label" data-i18n="builder.name"
                                       data-error="actionTitle">Название</label>
                                <input type="text" class="form-control" id="actionTitle" disabled>
                            </div>
                            <div class="col-md-8"></div>
                            <div class="col-md-4">
                                <label for="actionDescription" class="form-label" data-i18n="builder.description"
                                       data-error="ActionDescription">Описание:</label>
                                <textarea class="form-control" id="actionDescription" rows="3" disabled></textarea>
                                <div class="form-check mt-4">
                                    <input class="form-check-input" type="checkbox" value="" id="isAction"/>
                                    <label class="form-check-label" for="isAction" data-i18n="builder.isAction">
                                        Включить акцию
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-8"></div>
                            <div class="col-12 mt-4 text-end">
                                <button type="button" class="btn btn-primary me-2" data-i18n="builder.save">Сохранить
                                </button>
                                <a th:href="@{/builder}" class="btn btn-label-secondary"
                                   data-i18n="personal.cancel">Отмена</a>
                            </div>
                        </form>
                    </div>
                    <div class="tab-pane fade" id="navs-pills-top-profile" role="tabpanel">
                        <form action="/upload" class="dropzone needsclick" id="dropzone-basic">
                            <div class="dz-message needsclick">
                                Drop files here or click to upload
                                <span class="note needsclick">(This is just a demo dropzone. Selected files are
                                    <span class="fw-medium">not</span> actually uploaded.)
                                </span>
                            </div>
                            <div class="fallback">
                                <input name="file" type="file" />
                            </div>
                        </form>

                        <template id="preview-template">
                            <div class="dz-preview dz-file-preview">
                                <div class="dz-image"><img data-dz-thumbnail /></div>
                                <div class="dz-details">
                                    <div class="dz-size"><span data-dz-size></span></div>
                                    <div class="dz-filename"><span data-dz-name></span></div>
                                </div>
                                <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>
                                <div class="dz-error-message"><span data-dz-errormessage></span></div>
                                <div class="dz-success-mark">✔️</div>
                                <div class="dz-error-mark">❌</div>
                            </div>
                        </template>
                    </div>
                    <div class="tab-pane fade" id="navs-pills-top-messages" role="tabpanel">
                        <p>
                            Oat cake chupa chups dragée donut toffee. Sweet cotton candy jelly beans macaroon gummies
                            cupcake gummi bears cake chocolate.
                        </p>
                        <p class="mb-0">
                            Cake chocolate bar cotton candy apple pie tootsie roll ice cream apple pie brownie cake.
                            Sweet
                            roll icing sesame snaps caramels danish toffee. Brownie biscuit dessert dessert. Pudding
                            jelly
                            jelly-o tart brownie jelly.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script th:src="@{/customAssets/js/pravnyk/validator.js}"></script>
    <script th:src="@{/assets/vendor/libs/dropzone/dropzone.js}"></script>
    <script src="https://unpkg.com/i18next@21.6.16/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-http-backend@1.4.2/i18nextHttpBackend.min.js"></script>
    <script src="https://unpkg.com/jquery-i18next@1.2.1/dist/umd/jquery-i18next.min.js"></script>

    <script>
        const myDropzone = new Dropzone('#dropzone-basic', {
            previewTemplate: document.querySelector('#preview-template').innerHTML,
            parallelUploads: 1,
            maxFilesize: 5,
            addRemoveLinks: true,
            maxFiles: 1
        });
    </script>
    <script>
        i18next
            .use(i18nextHttpBackend)
            .init({
                lng: 'en',
                fallbackLng: 'en',
                backend: {
                    loadPath: '/admin/assets/json/locales/{{lng}}.json'
                }
            }, function () {
                jqueryI18next.init(i18next, $, {
                    useOptionsAttr: true
                });
                $('body').localize();
            });

        function changeLangMy(lang) {
            i18next.changeLanguage(lang, function () {
                $('body').localize();
            });
        }
    </script>
    <script>
        function includeAd() {
            $("#isAction").on('click', function () {
                const title = $('#actionTitle');
                const description = $('#actionDescription');
                console.log($(this).prop('checked'));
                if ($(this).prop('checked')) {
                    title.prop('required', true).prop('disabled', false);
                    description.prop('required', true).prop('disabled', false);
                } else {
                    title.prop('required', false).prop('disabled', true);
                    description.prop('required', false).prop('disabled', true);
                }
            });
        }

        function saveRequest(url, method, formData) {
            $.ajax({
                type: method,
                url: url,
                data: formData,
                processData: false,
                contentType: false,
                success: function () {
                    window.location.replace(`/admin/builder`);
                },
                error: function (error) {
                    clearValid();
                    let data = JSON.parse(error.responseText);
                    console.log(data);
                    validate(data);
                    console.log("Error submitting form:", error);
                }
            });
        }

        function getFormData() {
            const resForm = new FormData();
            resForm.append("name", $('#name').val());
            resForm.append("nameDistinct", $('#regDistrictId').val());
            resForm.append("cityId", $('#cityId').val());
            resForm.append("districtId", $('#districtId').val());
            resForm.append("topozoneId", $('#topozoneId').val());
            resForm.append("deliveryDateId", $('#deliveryDateId').val());
            resForm.append("street", $('#street').val());
            resForm.append("houseNumber", $('#houseNumber').val());
            resForm.append("houseSection", $('#houseSection').val());
            resForm.append("totalFloor", $('#totalFloor').val());
            resForm.append("buildingCompany", $('#buildingCompanyId').val());
            resForm.append("phoneNumber", $('#phoneNumber').val());
            resForm.append("description", $('#description').val());
            resForm.append("isAction", $('#isAction').val());

            let files = [
                {id: "#chessPlanFile", fieldName: "chessPlanFile"},
                {id: "#mortgageConditionsFile", fieldName: "mortgageConditionsFile"},
                {id: "#priceFile", fieldName: "priceFile"},
            ];

            files.forEach(function (fileObj) {
                let file = $(fileObj.id)[0].files[0];
                if (file) {
                    resForm.append(fileObj.fieldName, file);
                }
            });
            return resForm;
        }
    </script>
    <script>
        const containerCitySelector = $('#cityId');
        const containerBuildingCompanySelector = $('#buildingCompanyId');
        const containerTopozoneSelector = $('#topozoneId');
        let containerRegDistrictSelector = $('#regDistrictId');
        let containerDistrictSelector = $('#districtId');

        function loadCitiesByRegDistrictId(regDistrictId) {
            fetch(`/admin/city/get?regDistrictId=` + encodeURIComponent(regDistrictId))
                .then(response => response.json())
                .then(data => {
                    if (containerCitySelector) {
                        containerCitySelector.prop('disabled', false);
                        containerDistrictSelector.prop('disabled', true);
                        containerTopozoneSelector.prop('disabled', true);
                        let optionFirst = containerCitySelector.find('option').first();
                        containerCitySelector.empty();
                        containerCitySelector.append(optionFirst);
                        data.forEach(el => {
                            containerCitySelector.append(`<option value="${el.id}">${el.name}</option>`);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    showErrorMessage('Ошибка при загрузке данных');
                });
        }

        function loadBuildCompanies() {
            fetch(`/admin/builderCompany/getAll`)
                .then(response => response.json())
                .then(data => {
                    if (containerBuildingCompanySelector) {
                        let optionFirst = containerBuildingCompanySelector.find('option').first();
                        containerBuildingCompanySelector.empty();
                        containerBuildingCompanySelector.append(optionFirst);
                        data.forEach(el => {
                            containerBuildingCompanySelector.append(`<option value="${el.id}">${el.name}</option>`);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    showErrorMessage('Ошибка при загрузке данных');
                });
        }

        function loadTopZonesByDistrict(districtId) {
            fetch(`/admin/topozone/get?districtId=` + encodeURIComponent(districtId))
                .then(response => response.json())
                .then(data => {
                    if (containerTopozoneSelector) {
                        containerTopozoneSelector.prop('disabled', false);
                        let optionFirst = containerCitySelector.find('option').first();
                        containerTopozoneSelector.empty();
                        containerTopozoneSelector.append(optionFirst);
                        data.forEach(el => {
                            containerTopozoneSelector.append(`<option value="${el.id}">${el.name}</option>`);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    showErrorMessage('Ошибка при загрузке данных');
                });
        }

        const translate = (key) => {
            return i18next.isInitialized ? i18next.t(key) : key;
        };

        function loadRegDistrict() {
            fetch(`/admin/regDistrict/getAll`)
                .then(response => response.json())
                .then(data => {
                    if (containerRegDistrictSelector) {
                        containerCitySelector.prop('disabled', true);
                        containerDistrictSelector.prop('disabled', true);
                        containerTopozoneSelector.prop('disabled', true);
                        let firstOption = containerRegDistrictSelector.find('option').first();
                        containerRegDistrictSelector.empty();
                        containerRegDistrictSelector.append(firstOption);
                        data.forEach(el => {
                            containerRegDistrictSelector.append(`<option value="${el.id}">${el.name}</option>`);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    showErrorMessage('Ошибка при загрузке данных');
                });
        }

        function loadDistrictByCity(cityId) {
            fetch(`/admin/district/get?cityId=` + encodeURIComponent(cityId))
                .then(response => response.json())
                .then(data => {
                    if (containerDistrictSelector) {
                        containerDistrictSelector.prop('disabled', false);
                        containerTopozoneSelector.prop('disabled', true);
                        let optionFirst = containerTopozoneSelector.find('option').first();
                        containerDistrictSelector.empty();
                        containerDistrictSelector.append(optionFirst);
                        data.forEach(el => {
                            containerDistrictSelector.append(`<option value="${el.id}">${el.name}</option>`);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                    showErrorMessage('Ошибка при загрузке данных');
                });
        }
    </script>
    <script>
        function handleSelectChange(selectorId, targetSelectors, loaderFn) {
            $(selectorId).on('change', function () {
                const value = $(this).val();
                if (value) {
                    loaderFn(value);
                } else {
                    targetSelectors.forEach(el => {
                        el.prop('disabled', true);
                        el.find('option:not(:first)').remove();
                    });
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            loadRegDistrict();
            loadBuildCompanies();
            includeAd();
            handleSelectChange('#regDistrictId', [containerCitySelector, containerDistrictSelector, containerTopozoneSelector], loadCitiesByRegDistrictId);
            handleSelectChange('#cityId', [containerDistrictSelector, containerTopozoneSelector], loadDistrictByCity);
            handleSelectChange('#districtId', [containerTopozoneSelector], loadTopZonesByDistrict);

            const form = document.getElementById('personalForm');
            const builderIdInput = document.getElementById('builderId');
            const titleElement = document.querySelector('[data-i18n="builder.createTarget"]');
            const passwordField = document.querySelector('.col-md-6:has(#password)');

            // Определяем режим редактирования из URL
            const urlParams = new URLSearchParams(window.location.search);
            const builderId = urlParams.get('id');
            const isEdit = !!builderId;

            if (isEdit) {
                builderIdInput.value = builderId;
                titleElement.textContent = 'Редактировать здание';
                if (passwordField) {
                    passwordField.style.display = 'none';
                }

                // Загружаем данные пользователя
                fetch(`/admin/builder/${builderId}`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('role').value = data.role;
                        document.getElementById('surname').value = data.surname;
                        document.getElementById('name').value = data.name;
                        document.getElementById('lastName').value = data.lastName || '';
                        document.getElementById('phoneNumber').value = data.phoneNumber;
                        document.getElementById('email').value = data.email;
                    })
                    .catch(error => {
                        console.error('Error loading user data:', error);
                        showErrorMessage('Ошибка при загрузке данных пользователя');
                    });
            }

            // Обработка отправки формы
            // form.addEventListener('submit', function (event) {

            // event.preventDefault();
            // event.stopPropagation();
            // form.classList.add('was-validated');

            // if (form.checkValidity()) {
            // const formData = new FormData();
            // formData.append("name",$('#name').val());
            // formData.append("street",$('#street').val());
            // formData.append("totalFloor",$('#totalFloor').val());
            // formData.append("cityId",$('#cityId').val());
            // formData.append("districtId",$('#districtId').val());
            // formData.append("topozoneId",$('#topozoneId').val());
            // formData.append("buildingCompanyId",$('#buildingCompanyId').val());
            // formData.append("deliveryDateId",$('#deliveryDateId').val());
            // formData.append("houseNumber",$('#houseNumber').val());
            // formData.append("houseSection",$('#houseSection').val());
            // formData.append("phoneNumber",$('#phoneNumber').val());
            // formData.append("description",$('#description').val());
            // formData.append("actionTitle",$('#actionTitle').val());
            // formData.append("actionDescription",$('#actionDescription').val());
            // formData.append("isAction",$('#isAction').prop('checked'));

            // let filePricesEl = $('#priceFile');
            // if (filePricesEl[0].files.length > 0) formData.append('priceFile', filePricesEl[0].files[0]);
            // let filesInstallmentEl = $('#mortgageConditionsFile');
            // if (filesInstallmentEl[0].files.length > 0) formData.append('mortgageConditionsFile', filesInstallmentEl[0].files[0]);
            // let fileChessEl = $('#chessPlanFile');
            // if (fileChessEl[0].files.length > 0) formData.append('chessPlanFile', fileChessEl[0].files[0]);
            // const formData = {
            //     name: document.getElementById('name').value,
            //     street: document.getElementById('street').value,
            //     totalFloor: document.getElementById('totalFloor').value,
            //     cityId: document.getElementById('cityId').value,
            //     districtId: document.getElementById('districtId').value,
            //     topozoneId: document.getElementById('topozoneId').value,
            //     buildingCompanyId: document.getElementById('buildingCompanyId').value,
            //     deliveryDateId: document.getElementById('deliveryDateId').value,
            //     houseNumber: document.getElementById('houseNumber').value,
            //     houseSection: document.getElementById('houseSection').value,
            //     phoneNumber: document.getElementById('phoneNumber').value,
            //     description: document.getElementById('description').value,
            //     actionDescription: document.getElementById('actionDescription').value,
            //     isAction: document.getElementById('isAction').value,
            // };

            const url = isEdit ? `/admin/builder/${builderId}/save` : '/admin/builder/save';
            const method = isEdit ? 'PUT' : 'POST';
            $('[data-i18n="builder.save"]').on('click', function () {
                saveRequest(url, method, collectFormData())
            });

            // saveRequest(url,method,collectFormData());
            // fetch(url, {
            //     method: method,
            //     body: formData,
            //     processData: false,
            //     contentType: false,
            // })
            //     .then(response => {
            //         if (!response.ok) {
            //             throw new Error('Network response was not ok');
            //         }
            //         return response.json();
            //     })
            //     .then(data => {
            //         console.log(data);
            //         if (data.success) {
            //             window.location.href = '/admin/builder';
            //         } else {
            //             showErrorMessage(data.message || 'Произошла ошибка при сохранении');
            //         }
            //     })
            //     .catch(error => {
            //         console.error('Error:', error);
            //         showErrorMessage('Произошла ошибка при сохранении');
            //     });
            // }
            // });
        });

        function collectFormData(selector = 'form') {
            const formData = new FormData();
            const $elements = $(`${selector} input, ${selector} select, ${selector} textarea`);
            $elements.each(function () {
                const $el = $(this);
                const name = $el.attr('id');
                console.log(name);
                console.log($el.val());
                if (!name) return;
                if ($el.attr('type') === 'checkbox') {
                    formData.append(name, $el.prop('checked'));
                } else if ($el.attr('type') === 'file') {
                    const files = $el[0].files;
                    if (files.length > 0) {
                        formData.append(name, files[0]);
                    }
                } else {
                    formData.append(name, $el.val());
                }
            });

            return formData;
        }

        function showErrorMessage(message) {
            // Здесь можно добавить логику отображения ошибок пользователю
            // Например, через всплывающее уведомление или в определенном месте на странице
            alert(message);
        }
    </script>
</div>
</body>
</html>